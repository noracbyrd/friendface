<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/app/public/additionalstyle.css">
</head>

<body>
    <div class="container">

        <!-- @ Image and text -->
        <nav class="navbar navbar-light bg-light">
            <a class="navbar-brand" href="#">
                <img src="#" width="30" height="30" class="d-inline-block align-top" alt="">
                friendFace Survey
            </a>
        </nav>
        <br>
        <div class="row">
            <div class="col-md-2">
                <!--empty div for spacing-->
            </div>
            <div class="col-md-8">
                <form>
                    <div id="personal">
                        <h4>About You</h4>
                        <div class="form-group">
                            <label required for="name">Name (Required)</label>
                            <textarea name="name" class="form-control" id="name" rows="1"></textarea>
                        </div>
                        <div class="form-group">
                            <label required for="picture">Link to Profile Image (Required)</label>
                            <textarea name="picture" class="form-control" id="picture" rows="1"></textarea>
                        </div>
                    </div>
                    <br>
                    <div id="survey">
                        <h5>Please answer the following questions.</h5>
                        <h6>The scale is: 1 to Strongly Disagree, 5 to Strongly Agree, 3 for Neutral.</h6>
                        <br>
                        <div class="form-group">
                            <h5>Question 1</h5>
                            <label for="question1">You love to sing.</label>
                            <select name="question1" class="form-control" id="question1">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 2</h5>
                            <label for="question2">You have a loveable animal sidekick.</label>
                            <select name="question2" class="form-control" id="question2">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 3</h5>
                            <label for="question3">You love to be near water.</label>
                            <select name="question3" class="form-control" id="question3">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 4</h5>
                            <label for="question4">Family always comes first.</label>
                            <select name="question4" class="form-control" id="question4">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 5</h5>
                            <label for="question5">You'd rather dress practically than fashionably.</label>
                            <select name="question5" class="form-control" id="question5">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 6</h5>
                            <label for="question6">You enjoy spending time alone.</label>
                            <select name="question6" class="form-control" id="question6">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 7</h5>
                            <label for="question7">You're a big city person.</label>
                            <select name="question7" class="form-control" id="question7">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 8</h5>
                            <label for="question8">You're a hopeless romantic.</label>
                            <select name="question8" class="form-control" id="question8">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 9</h5>
                            <label for="question9">You love to travel.</label>
                            <select name="question9" class="form-control" id="question9">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <h5>Question 10</h5>
                            <label for="question10">You often get lost in your imagination.</label>
                            <select name="question10" class="form-control" id="question10">
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" href="#" id="submit" class="btn btn-secondary">Submit</button>
                </form>
                <br>
            </div>
            <div class="col-md-2">
                <!--empty div for spacing-->
            </div>
            <!-- Modal -->
            <div id="myModal" class="modal">
                <!-- Modal content -->
                <div class="modal-content" id="theContent">
                    <button class="close btn-secondary">Close X</button>
                    <p id="matchName">Some text in the Modal..</p>
                    <div id="matchPicture"></div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript">
        // setting up the onclick to post the data to the backend
        $("#submit").on("click", function (event) {
            event.preventDefault();
            // grabbing all the answers
            var addedFriend = {
                name: $("#name").val().trim(),
                picture: $("#picture").val().trim(),
                question1: $("#question1").val(),
                question2: $("#question2").val(),
                question3: $("#question3").val(),
                question4: $("#question4").val(),
                question5: $("#question5").val(),
                question6: $("#question6").val(),
                question7: $("#question7").val(),
                question8: $("#question8").val(),
                question9: $("#question9").val(),
                question10: $("#question10").val()
            };
            // sending the answers to the api/friends route
            $.post("/api/friends", addedFriend,
                function (data) {
                    // setting up the modal first
                    var modal = document.getElementById("myModal");
                    modal.style.display = "block";
                    // populating the modal with the friend match
                    // warning, this is a very scary modal
                    $("#matchName").text(`Congratulations, you matched with ${data.name}!`);
                    $("#matchPicture").html(`<img src=${data.picture} alt="match image of ${data.name}">`);
                    // Get the <span> element that closes the modal
                    var span = document.getElementsByClassName("close")[0];
                    // When the user clicks on <span> (x), close the modal
                    span.onclick = function () {
                        modal.style.display = "none";
                    }
                    // When the user clicks anywhere outside of the modal, close it
                    window.onclick = function (event) {
                        if (event.target == modal) {
                            modal.style.display = "none";
                        }
                    }
                });
        });
    </script>
</body>
</html>